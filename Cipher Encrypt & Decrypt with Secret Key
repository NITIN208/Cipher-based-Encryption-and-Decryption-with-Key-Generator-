# Program to Encrypt and Decrypt a Message with a Input of Secret Key

import string

chars = " " + string.punctuation + string.digits + string.ascii_letters
chars = list(chars)

# Input the key
key_input = input("Enter the Random Generated Passkey : ")
key = eval(key_input) 


if sorted(key) != sorted(chars):
    raise ValueError("Invalid key! The key must contain all characters from the original character set.")

while True:
    # Ask for action: Encrypt or Decrypt
    action = input("Do you want to Encrypt or Decrypt a message? ").strip().lower()

    if action == "e":
        # ENCRYPT
        plain_text = input("Enter a message to encrypt: ")
        cipher_text = ""

        for letter in plain_text:
            index = chars.index(letter)
            cipher_text += key[index]

        print(f"Original message : {plain_text}")
        print(f"Encrypted message: {cipher_text}")

    elif action == "d":
        # DECRYPT
        cipher_text = input("Enter a message to decrypt: ")
        plain_text = ""

        for letter in cipher_text:
            index = key.index(letter)
            plain_text += chars[index]

        print(f"Encrypted message: {cipher_text}")
        print(f"Original message : {plain_text}")

    else:
        print("Invalid action! Please choose 'E' for encrypt or 'D' for decrypt.")

    # Ask if the user wants to continue or change the action
    continue_choice = input("Do you want to continue with the same action or change? Continue/ Switch/ Quit: ").strip().lower()

    if continue_choice == "q":
        print("Exiting the program!")
        break
    elif continue_choice == "s":
        print("Switching action...")
        continue
    elif continue_choice == "c":
        print("Continuing with the current action...")
    else:
        print("Invalid choice! Defaulting to switching action.")
